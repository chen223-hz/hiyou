{% extends "scenic/index.html" %}
{% block header %}
<link rel="stylesheet" href="http://cdn.datatables.net/plug-ins/28e7751dbec/integration/bootstrap/3/dataTables.bootstrap.css">
<style type="text/css">
   
    .EquList .box{
      border-top:0px solid #fff;
    }
    .EquList #example1_wrapper section{
       border-bottom:1px solid #d2d6de ;
    }
     .EquList #example1_wrapper section h3{
      font-size:15px; 
      border-left:4px solid #0073b7; 
      margin-top: 0px;
      padding-left: 2px;
      color:#777;
    }
     .EquList  #example1_filter{
      margin:20px 0 20px 0px;
     }
     .EquList button{
      margin-left:5px;
     }
     .EquList .MacSearch .SetLogOut{
      float:right;
     }
     .EquList .SetLogOut div{
      margin-left:10px;
     }
     .MiddlePage{
      text-align: center;
     }
     .column li {
      display: inline-block;
      list-style: none;
      width: 70px;
    }
     .box-body select {
      line-height: 30px;
      margin:20px;
      width: 20%;
      font-size: 15px;
      border-radius: 6px;   
    }
    div.dataTables_filter {
      text-align: start;
      margin: 20px;
    }
    label {
      display: inline-block;
      max-width: 100%;
      margin-bottom: 5px;
      font-weight: inherit;
    }
    .SetLogOut{
      font-size:15px; 
      border-left:4px solid #0073b7; 
      margin-top: 0px;
      padding-left: 2px;
      color:#777;
    }
    .breadcrumb {
      padding: 0px 15px;
      margin-bottom: auto;
      list-style: none;
      background:#fff;
    }
    ol, ul {
      margin-top: 0;
      margin-bottom: 0px;
    }
    .Setspan{
      padding: 0px 15px;
    }
    a {
      color: #484141;
      text-decoration: none;
    }
</style>
{% endblock %}
{% block content %}

<section class="TopTitle">
	<section class="content-header AllTitle">
		<h1>
			<span><a href="javascript:location.reload();">探针数据</a></span>       
		</h1>
	</section>
	<section class="OrderTab CommodityTab">
	<ul class="nav nav-tabs" role="tablist">
		<li role="presentation" class="active"><a href="#home" role="tab" data-toggle="tab">实时查询 </a></li>
		<li role="presentation" class='Setspan'><a href="#profile" role="tab" data-toggle="tab">统计日表</a></li>
	</ul>
	</section>
</section>
<section class="content">
  <div class="row EquList">
    <div class="col-xs-12" style="padding-right:0px;">
      <div class="box">
        <div class="box-body" >
            <div class="tab-content"> 
              <div role="tabpanel" class="tab-pane active" id="home">   
                <section  style="background:#fff;border-left: 1px solid #d3d4d4; padding:5px;">
                  <div class="row " >
                    <div class="col-sm-12">
                      <label class="" style="float:right;">刷新时间:<span class='time'> </span>&nbsp;&nbsp;&nbsp;
                        <a href="javascript:location.reload();" class='' title="刷新">  <i class="fa fa-refresh"> </i></a>
                      </label>
                    </div>
                  </div>
                </section>
                <div class="row"  style="background:#fff; margin:20px 20px 0 20px;">
                  <div class="col-sm-12">
                    <table id="example1" class="table table-bordered table-striped dataTable" role="grid" aria-describedby="example1_info" style="text-align: center;">
                      <thead>
                      <tr role="row">
                        <th class="sorting_asc" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Rendering engine: activate to sort column descending" style="width:12%; text-align: center;">设备MAC</th>
                        <th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Platform(s): activate to sort column ascending" style="width:12%; text-align: center;">终端MAC</th>
                        <th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Engine version: activate to sort column ascending" style="width:12%; text-align: center;">信号强度</th>
                        <th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="CSS grade: activate to sort column ascending" style="width:12%; text-align: center;">终端类型</th>
                        <th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="CSS grade: activate to sort column ascending" style="width:12%; text-align: center;">探测时间</th>
                      </tr>
                      </thead>
                      <tbody class = 'oddd'> 
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
              <div role="tabpanel" class="tab-pane" id="profile">
                <section class="OrderTab CommodityTab">
                  <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active"><a href="#adad" role="tab" data-toggle="tab">按终端 </a></li>
                    <li role="presentation" class='Setspan'><a href="#qwqw" role="tab" data-toggle="tab">按探针</a></li>
                  </ul>
                </section>
                <div class="tab-content">
                  <div role="tabpanel" class="tab-pane fade in active" id="adad">
                    <div class="row" style="background:#fff; margin:20px 0 0 20px;">
                      <div class="col-sm-12">
                        <table id="example1" class="table table-bordered table-striped dataTable" role="grid" aria-describedby="example1_info" style="text-align: center;">
                          <thead>
                          <tr role="row">
                            <th class="sorting_asc" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Rendering engine: activate to sort column descending" style="width:12%; text-align: center;">探针MAC</th>
                            <th class="sorting_asc" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Rendering engine: activate to sort column descending" style="width:12%; text-align: center;">探测日期</th>
                            <th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Platform(s): activate to sort column ascending" style="width:12%; text-align: center;">探测终端数</th>
                          </tr>
                          </thead>
                          <tbody class = 'oddd'>
                            {% for obj1 in obj %}       
                            <tr role="row" class="odd">
                              <td class="sorting_1">{{ obj1.mac }}</td>
                              <td class="sorting_1">{{ obj1.create }}</td>
                              <td>{{obj1.num}}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                  <div role="tabpanel" class="tab-pane" id="qwqw">
                    <div class="row" style="background:#fff; margin:20px 0 0 20px;">
                      <div class="col-sm-12">
                        <table id="example1" class="table table-bordered table-striped dataTable" role="grid" aria-describedby="example1_info" style="text-align: center;">
                          <thead>
                          <tr role="row">
                            <th class="sorting_asc" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Rendering engine: activate to sort column descending" style="width:12%; text-align: center;">探针MAC</th>
                            <th class="sorting_asc" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Rendering engine: activate to sort column descending" style="width:12%; text-align: center;">探测日期</th>
                            <th class="sorting" tabindex="0" aria-controls="example1" rowspan="1" colspan="1" aria-label="Platform(s): activate to sort column ascending" style="width:12%; text-align: center;">探测终端数</th>
                          </tr>
                          </thead>
                          <tbody class = 'oddd'>
                            {% for obj1 in obj %}       
                            <tr role="row" class="odd">
                              <td class="sorting_1">{{ obj1.mac }}</td>
                              <td class="sorting_1">{{ obj1.create }}</td>
                              <td>{{obj1.num}}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
      </div> 
    </div><!-- /.col -->
  </div><!-- /.row -->
</section>
{% endblock %}
{% block script %}
    
<script src="http://cdn.doublecom.net/adminlte2/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="http://cdn.doublecom.net/adminlte2/plugins/datatables/dataTables.bootstrap.min.js"></script>
<script src="http://cdn.doublecom.net/adminlte2/plugins/slimScroll/jquery.slimscroll.min.js"></script>
<script src="http://cdn.doublecom.net/adminlte2/plugins/fastclick/fastclick.js"></script>
<script src="http://cdn.doublecom.net/adminlte2/dist/js/demo.js"></script>
<script type="text/javascript">
  post_dev()
  getNowFormatDate()
  function post_dev(){
    $.ajax({
      url:'/scenic/probe/',
      data:{},
      type:'post',
      async:false,
      dataType:'JSON',
      success:function(d,s,x){
          var data=d
          var len=data.length
          var tr=$('tbody.oddd').empty();
          for(var i=0;i<len;i++){
            var ti_h='<tr role="row" class="odd" data-ipaddr="" ><td>'+data[i].mac+'</td><td>'+data[i].macc +'</td><td>'+data[i].signal+'</td><td>'+data[i].type+'</td><td>'+data[i].time+'</td></tr>'
            tr.append(ti_h);
          }
      },
      error:function(x,s,e){
        //alert()
      }
    })
  } 
$(".update").click(function (event) {
  getNowFormatDate()
  post_dev()
});
function getNowFormatDate() {
    var date = new Date();
    var seperator1 = "-";
    var seperator2 = ":";
    var month = date.getMonth() + 1;
    var strDate = date.getDate();
    var hour = date.getHours();
    var minute = date.getMinutes();
    var second = date.getSeconds();
    console.log(date.getDate())
    if (month >= 1 && month <= 9) {
        month = "0" + month;
    }
    if (strDate >= 0 && strDate <= 9) {
        strDate = "0" + strDate;
    }
    if (hour >= 0 && hour <= 9) {
        hour = "0" + hour;
    }
    if (minute >= 0 && minute <= 9) {
        minute = "0" + minute;
    }
    if (second >= 0 && second <= 9) {
        second = "0" + second;
    }
    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
            + " " + hour + seperator2 + minute
            + seperator2 + second;
    $('.time').text(currentdate)
}

  $(function () {
    $("#example1").DataTable({
      language: {
        "sProcessing": "处理中...",
        "sLengthMenu": "显示 _MENU_ 项结果",
        "sZeroRecords": "没有匹配结果",
        "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
        "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
        "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
        "sInfoPostFix": "",
        "sSearch": "搜索：",
        "sUrl": "",
        "sEmptyTable": "表中数据为空",
        "sLoadingRecords": "载入中...",
        "sInfoThousands": ",",
        "oPaginate": {
           "sFirst": "首页",
           "sPrevious": "上页",
           "sNext": "下页",
           "sLast": "末页"
        },
        "oAria": {
           "sSortAscending": ": 以升序排列此列",
           "sSortDescending": ": 以降序排列此列"
        }
      }
    })  
    $('#example2').DataTable({
      "paging": true,
      "lengthChange": false,
      "searching": false,
      "ordering": true,
      "info": true,
      "autoWidth": false,
      language: {
         "sProcessing": "处理中...",
         "sLengthMenu": "显示 _MENU_ 项结果",
         "sZeroRecords": "没有匹配结果",
         "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
         "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
         "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
         "sInfoPostFix": "",
         "sSearch": "搜索：",
         "sUrl": "",
         "sEmptyTable": "表中数据为空",
         "sLoadingRecords": "载入中...",
         "sInfoThousands": ",",
         "oPaginate": {
             "sFirst": "首页",
             "sPrevious": "上页",
             "sNext": "下页",
             "sLast": "末页"
         },
         "oAria": {
             "sSortAscending": ": 以升序排列此列",
             "sSortDescending": ": 以降序排列此列"
         }
      }    
    })
  })
</script>
{% endblock %}